<app-onboarding-stepper [currentStep]="'Import Settings'"></app-onboarding-stepper>
<div *ngIf="!isLoading" fxLayout="column" fxLayoutAlign="space-around center">
  <div>
    Import Settings
  </div>
  <div>
    You can Enable all the data that you wish to import from Quickbooks Online. All the imported data from Quickbooks Online would be available in Fyle under Admin Setting > Organization. Learn More
  </div>

  <form [formGroup]="importSettingsForm">
    Import Chart of Accounts from Quickbooks Online
    <mat-slide-toggle color="accent" formControlName="chartOfAccount">
    </mat-slide-toggle>

    <div *ngIf="importSettingsForm.value.chartOfAccount">
      Select the accounts from QBO to import as categories in Fyle
      <div formArrayName="chartOfAccountTypes">
        <p *ngFor="let chartOfAccountType of chartOfAccountTypes.controls; let i = index" [formGroupName]="i">
          <mat-checkbox formControlName="enabled" [checked]="chartOfAccountType.value.enabled" [disabled]="chartOfAccountType.value.name === 'Expense'">
            {{ chartOfAccountType.value.name }}
          </mat-checkbox>
        </p>
      </div>
    </div>

    <div formArrayName="expenseFields">
      <div *ngFor="let expenseField of expenseFields.controls; let i = index" [formGroupName]="i">
        Import {{ expenseField.value.destination_field | titlecase }} from Quickbooks Online
        <mat-slide-toggle color="accent" [disabled]="expenseField.value.disable_import_to_fyle" formControlName="import_to_fyle">
        </mat-slide-toggle>

        <div>
          <input type="text" value="{{ expenseField.value.destination_field | titlecase }} in QBO" disabled="true" matInput>
          <mat-select placeholder="Select a field from Fyle" formControlName="source_field">
            <mat-option *ngFor="let fyleExpenseField of fyleExpenseFields" [value]="fyleExpenseField">
              {{ fyleExpenseField.split('_').join(' ') | titlecase }}
            </mat-option>
          </mat-select>
          <div *ngIf="!expenseField.value.source_field">
            or <button mat-button color="accent" (click)="createExpenseField(expenseField.value.destination_field)">Create a new field in Fyle</button>
          </div>
        </div>
      </div>
    </div>

    <div>
      Import Tax Code from QBO
      <mat-slide-toggle color="accent" formControlName="taxCode">
      </mat-slide-toggle>

      <div *ngIf="importSettingsForm.value.taxCode">
        Select the default tax code
        <mat-select placeholder="Select Default Tax Code" formControlName="defaultTaxCode">
          <mat-option *ngFor="let option of taxCodes" [value]="{id: option.id, name: option.value}">
            {{ option.value }}
          </mat-option>
        </mat-select>
      </div>
    </div>
  </form>

  <div>
    <button [disabled]="!importSettingsForm.valid" color="accent" mat-flat-button (click)="save()">
      Continue ->
    </button>
  </div>

</div>