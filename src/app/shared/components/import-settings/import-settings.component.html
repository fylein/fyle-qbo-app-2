<app-onboarding-stepper [currentStep]="'Import Settings'"></app-onboarding-stepper>
<div *ngIf="!isLoading" fxLayout="column" fxLayoutAlign="space-around center">
  <div>
    Import Settings
  </div>
  <div>
    You can Enable all the data that you wish to import from Quickbooks Online. All the imported data from Quickbooks Online would be available in Fyle under Admin Setting > Organization. Learn More
  </div>

  <form [formGroup]="importSettingsForm">
    Import Chart of Accounts from Quickbooks Online
    <mat-slide-toggle color="accent" formControlName="chartOfAccount">
    </mat-slide-toggle>

    <div *ngIf="importSettingsForm.value.chartOfAccount">
      Select the accounts from QBO to import as categories in Fyle
      <div formArrayName="chartOfAccountTypes">
        <p *ngFor="let chartOfAccountType of chartOfAccountTypes.controls; let i = index" [formGroupName]="i">
          <mat-checkbox formControlName="enabled" [checked]="chartOfAccountType.value.enabled" [disabled]="chartOfAccountType.value.name === 'Expense'">
            {{ chartOfAccountType.value.name }}
          </mat-checkbox>
        </p>
      </div>
    </div>

    <div>
      Import Classes from Quickbooks Online
      <mat-slide-toggle color="accent" formControlName="class">
      </mat-slide-toggle>

      <div *ngIf="importSettingsForm.value.class">
        <input type="text" value="Classes in QBO" disabled="true" matInput>
        <mat-select placeholder="Select a field from Fyle" formControlName="classMapping">
          <mat-option *ngFor="let fyleExpenseField of fyleExpenseFields" [value]="fyleExpenseField">
            {{ fyleExpenseField.source_field.split('_').join(' ') | titlecase }}
          </mat-option>
        </mat-select>
        <div *ngIf="!importSettingsForm.value.classMapping">
          or <button mat-button color="accent" (click)="createExpenseField('CLASS')">Create a new field in Fyle</button>
        </div>
      </div>
    </div>

    <div>
      Import Department from Quickbooks Online
      <mat-slide-toggle color="accent" formControlName="department">
      </mat-slide-toggle>
      <div *ngIf="importSettingsForm.value.department">
        <input type="text" value="Departments in QBO" disabled="true" matInput>
        <mat-select placeholder="Select a field from Fyle" formControlName="departmentMapping">
          <mat-option *ngFor="let fyleExpenseField of fyleExpenseFields" [value]="fyleExpenseField">
            {{ fyleExpenseField.source_field.split('_').join(' ') | titlecase }}
          </mat-option>
        </mat-select>
        <div *ngIf="!importSettingsForm.value.departmentMapping">
          or <button mat-button color="accent" (click)="createExpenseField('DEPARTMENT')">Create a new field in Fyle</button>
        </div>
      </div>
    </div>

    <div>
      Import Customer from Quickbooks Online
      <mat-slide-toggle color="accent" formControlName="customer">
      </mat-slide-toggle>
      <div *ngIf="importSettingsForm.value.customer">
        <input type="text" value="Customers in QBO" disabled="true" matInput>
        <mat-select placeholder="Select a field from Fyle" formControlName="customerMapping">
          <mat-option *ngFor="let fyleExpenseField of fyleExpenseFields" [value]="fyleExpenseField">
            {{ fyleExpenseField.source_field.split('_').join(' ') | titlecase }}
          </mat-option>
        </mat-select>
        <div *ngIf="!importSettingsForm.value.customerMapping">
          or <button mat-button color="accent" (click)="createExpenseField('CUSTOMER')">Create a new field in Fyle</button>
        </div>
      </div>
    </div>

    <div>
      Import Tax Code from QBO
      <mat-slide-toggle color="accent" formControlName="taxCode">
      </mat-slide-toggle>

      <div *ngIf="importSettingsForm.value.taxCode">
        Select the default tax code
        <mat-select placeholder="Select Default Tax Code" formControlName="defaultTaxCode">
          <mat-option *ngFor="let option of taxCodes" [value]="{id: option.id, name: option.value}">
            {{ option.value }}
          </mat-option>
        </mat-select>
      </div>
    </div>
  </form>

  <div>
    <button [disabled]="!importSettingsForm.valid" color="accent" mat-flat-button (click)="save()">
      Continue ->
    </button>
  </div>

</div>